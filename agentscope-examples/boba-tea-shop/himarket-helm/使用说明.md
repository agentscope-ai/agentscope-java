# HiMarket Auto-Init Helm Chart ä½¿ç”¨è¯´æ˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é»˜è®¤å®‰è£…ï¼ˆæ¨èï¼‰

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆåŒ…å« MCP è‡ªåŠ¨åˆå§‹åŒ–ï¼‰
helm install himarket ./himarket-auto-init
```

**åŒ…å«ï¼š**
- âœ… HiMarket Server + Admin + Frontend
- âœ… å†…ç½® MySQL
- âœ… è‡ªåŠ¨åˆå§‹åŒ–ç®¡ç†å‘˜å’Œå¼€å‘è€…è´¦å·
- âœ… è‡ªåŠ¨å¯¼å…¥ 5 ä¸ª MCP Server
- âœ… è‡ªåŠ¨åœ¨ HiMarket ä¸­ä¸Šæ¶ MCP

---

### 2. è‡ªå®šä¹‰ Server é•œåƒ

```bash
# ä½¿ç”¨è‡ªå·±çš„é•œåƒä»“åº“
helm install himarket ./himarket-auto-init \
  --set server.image.hub=your-registry.com/your-namespace \
  --set server.image.repository=himarket-server-auto-init \
  --set server.image.tag=v1.0.0 \
  --set imagePullSecrets[0].name=your-registry-secret
```

**è¯´æ˜ï¼š**
- Server é•œåƒå¯ä»¥è‡ªå®šä¹‰ï¼ˆç”¨æˆ·è‡ªå·±çš„é•œåƒä»“åº“ï¼‰
- Frontend å’Œ Admin ä½¿ç”¨å¼€æºé»˜è®¤é•œåƒï¼ˆä¸éœ€è¦ä¿®æ”¹ï¼‰
- æ”¯æŒé…ç½® ImagePullSecret

---

### 3. è®¿é—®æœåŠ¡

```bash
# ä½¿ç”¨ port-forward
kubectl port-forward svc/himarket-server 8080:80     # Server API
kubectl port-forward svc/himarket-admin 8001:80      # ç®¡ç†åå°
kubectl port-forward svc/himarket-frontend 3000:80   # å¼€å‘è€…é—¨æˆ·
```

**è®¿é—®åœ°å€ï¼š**
- Server API: http://localhost:8080
- ç®¡ç†åå°: http://localhost:8001
- å¼€å‘è€…é—¨æˆ·: http://localhost:3000

**ç™»å½•ä¿¡æ¯ï¼š**
- ç®¡ç†å‘˜: `admin` / `admin`
- å¼€å‘è€…: `demo` / `demo123`

---

## ğŸ“‹ æ ¸å¿ƒé…ç½®

### é•œåƒé…ç½®

```yaml
# é•œåƒæ‹‰å–å‡­è¯ï¼ˆé»˜è®¤ä½¿ç”¨ agentscopeï¼‰
imagePullSecrets:
  - name: agentscope

# Server é•œåƒï¼ˆå¯è‡ªå®šä¹‰ï¼‰
server:
  image:
    hub: your-registry.com/your-namespace
    repository: himarket-server-auto-init
    tag: v1.0.0

# Frontend é•œåƒï¼ˆä½¿ç”¨å¼€æºé»˜è®¤ï¼‰
frontend:
  image:
    hub: opensource-registry.cn-hangzhou.cr.aliyuncs.com/higress-group
    repository: himarket-frontend
    tag: latest

# Admin é•œåƒï¼ˆä½¿ç”¨å¼€æºé»˜è®¤ï¼‰
admin:
  image:
    hub: opensource-registry.cn-hangzhou.cr.aliyuncs.com/higress-group
    repository: himarket-admin
    tag: latest
```

### MCP é…ç½®ï¼ˆé»˜è®¤å¯ç”¨ï¼‰

```yaml
mcp:
  importToNacos: true       # å¯¼å…¥ MCP åˆ° Nacosï¼ˆé»˜è®¤ trueï¼‰
  publishToHimarket: true   # åœ¨ HiMarket ä¸­ä¸Šæ¶ MCPï¼ˆé»˜è®¤ trueï¼‰
```

**ç¦ç”¨ MCPï¼š**
```bash
helm install himarket ./himarket-auto-init \
  --set mcp.importToNacos=false \
  --set mcp.publishToHimarket=false
```

### MySQL é…ç½®

```yaml
# ä½¿ç”¨å†…ç½® MySQLï¼ˆé»˜è®¤ï¼‰
mysql:
  enabled: true

# ä½¿ç”¨å¤–éƒ¨ MySQL
mysql:
  enabled: false

database:
  host: your-mysql-host
  port: "3306"
  name: himarket
  username: root
  password: yourpassword
```

### Nacos é…ç½®ï¼ˆå¯é€‰ï¼‰

```yaml
nacos:
  enabled: true
  serverUrl: http://nacos:8848
  username: nacos
  password: nacos
  # å•†ä¸šåŒ– Nacos
  accessKey: LTAI5t...
  secretKey: xxx...
```

### ç½‘å…³é…ç½®ï¼ˆå¯é€‰ï¼‰

```yaml
# Higress ç½‘å…³
gateway:
  enabled: true
  type: HIGRESS
  higress:
    url: http://higress-console:8080

# é˜¿é‡Œäº‘ AI ç½‘å…³
gateway:
  enabled: true
  type: APIG_AI
  apig:
    region: cn-hangzhou
    accessKey: LTAI5t...
    secretKey: xxx...
```

---

## ğŸ¯ å¸¸ç”¨åœºæ™¯

### åœºæ™¯ 1: å¿«é€Ÿä½“éªŒï¼ˆé»˜è®¤ï¼‰

```bash
helm install himarket ./himarket-auto-init
```

### åœºæ™¯ 2: æœ€å°åŒ–ï¼ˆä¸å« MCPï¼‰

```bash
helm install himarket ./himarket-auto-init -f values-minimal.yaml
```

### åœºæ™¯ 3: å®Œæ•´åŠŸèƒ½ï¼ˆå« Nacos + Gateway + MCPï¼‰

```bash
helm install himarket ./himarket-auto-init -f values-full.yaml
```

### åœºæ™¯ 4: è‡ªå®šä¹‰é•œåƒ + å¤–éƒ¨ MySQL

```bash
helm install himarket ./himarket-auto-init \
  --set server.image.hub=your-registry.com \
  --set server.image.repository=himarket-server-auto-init \
  --set server.image.tag=v1.0.0 \
  --set mysql.enabled=false \
  --set database.host=your-mysql-host \
  --set database.password=yourpassword
```

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹çŠ¶æ€
kubectl get pods | grep himarket
kubectl get svc | grep himarket

# æŸ¥çœ‹æ—¥å¿—
kubectl logs -f -l app=himarket-server

# ç«¯å£è½¬å‘
kubectl port-forward svc/himarket-server 8080:80
kubectl port-forward svc/himarket-admin 8001:80
kubectl port-forward svc/himarket-frontend 3000:80

# å‡çº§
helm upgrade himarket ./himarket-auto-init \
  --set server.image.tag=v1.0.1 \
  --reuse-values

# å¸è½½
helm uninstall himarket

# åˆ é™¤æ•°æ®ï¼ˆå¦‚æœä½¿ç”¨å†…ç½® MySQLï¼‰
kubectl delete pvc -l app=mysql
```

---

## ğŸ“š æ›´å¤šæ–‡æ¡£

- **README.md** - å®Œæ•´è¯´æ˜æ–‡æ¡£
- **QUICKSTART.md** - 5 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹
- **USAGE.md** - è¯¦ç»†ä½¿ç”¨æŒ‡å—
- **ä¿®æ”¹è¯´æ˜.md** - ä¸åŸ Helm Chart çš„å¯¹æ¯”
- **éƒ¨ç½²è¯´æ˜.md** - è¯¦ç»†éƒ¨ç½²è¯´æ˜

---

## âœ… æ ¸å¿ƒç‰¹æ€§

1. âœ… **çº¯ Helm æ“ä½œ** - ä¸ä¾èµ–è„šæœ¬ï¼Œæ‰€æœ‰é…ç½®é€šè¿‡ values.yaml
2. âœ… **MCP é»˜è®¤å¯ç”¨** - è‡ªåŠ¨å¯¼å…¥å’Œä¸Šæ¶ 5 ä¸ªå†…ç½® MCP Server
3. âœ… **Server é•œåƒå¯è‡ªå®šä¹‰** - æ”¯æŒä½¿ç”¨è‡ªå·±çš„é•œåƒä»“åº“
4. âœ… **Frontend/Admin å¼€æºé»˜è®¤** - æ— éœ€ä¿®æ”¹
5. âœ… **æ”¯æŒ ImagePullSecret** - ç§æœ‰é•œåƒä»“åº“è®¤è¯

---

**ğŸ‰ ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼**

